\newlength\la@teachertextwidth
\newlength\la@prof@colsep
\newlength\la@prof@fullwidth
\newlength\la@prof@pagewidth
\newlength\la@prof@outermargin

\setlength{\la@teachertextwidth}{90mm}
\setlength{\la@prof@colsep}{2\la@studentspinemargin}
\setlength{\la@prof@fullwidth}{
    \la@studenttextwidth
    +\la@teachertextwidth
    +\la@prof@colsep
}
\setlength{\la@prof@pagewidth}{315mm}
\setlength{\la@prof@outermargin}{
    \la@prof@pagewidth
    -\la@prof@fullwidth
    -\la@studentspinemargin
}

\setstocksize{297mm}{315mm}
\settrimmedsize{297mm}{\la@prof@pagewidth}{*}
\settypeblocksize{247mm}{\la@prof@fullwidth}{*}

\setlrmarginsandblock{\la@studentspinemargin}{\la@prof@outermargin}{*}
\setulmarginsandblock{\la@studentuppermargin}{\la@studentlowermargin}{*}

\checkandfixthelayout%


\newtoggle{teacherenv}

\NewEnviron{teacher}[1]{%
    \par
    \toggletrue{teacherenv}
    \switchcolumn%
    \la@widelist
    {
        \BODY%
    }
    \hfil
    \switchcolumn%
    \la@defaultlist
    \togglefalse{teacherenv}
}

% paracol definitions
\twosided%
\setcolumnwidth{\la@studenttextwidth/\la@prof@colsep,\la@teachertextwidth}
\newcommand{\la@prof@backgroundcolor}{%
    \backgroundcolor{c[1] (.5\la@prof@colsep,25mm) (25mm,250mm)}{boxbackground}}

\newcommand{\toggleteachercol}{     
	\iftoggle{paracol}{
	}{
		\la@prof@backgroundcolor
		\begin{paracol}{2} % starts double column at the student's main text.
		\toggletrue{paracol}
	}
}

\newcommand{\untoggleteachercol}{
    \iftoggle{paracol}{
        \end{paracol}
        \togglefalse{paracol}
    }{}
}

\AtEndDocument{
	\clearpage
    \untoggleteachercol%
}
