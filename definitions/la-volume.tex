\RequirePackage{pagecolor}
\RequirePackage{titlesec}
\RequirePackage{tikz}

\newcommand{\volumeillustration}[1]{%
	\def\la@volumeillustration{#1}
}

\newcommand{\la@volume@illustration}{
	\ifdefined\la@volumeillustration
		\includegraphics[width=360bp]{\la@volumeillustration-volicon.pdf}
		\undef\la@volumeillustration
	\else\fi
}


\newcounter{volume}
\newcounter{la@volume}

\titleclass{\la@volume}{top}[\part]
	\providecommand*{\toclevel@la@volume}{0}
	\titlespacing{\la@volume}{0pt}{0pt}{0pt}
	\titleformat{\la@volume}[block]{\volumetitlefont}{% numbering
		\parbox{%
			\widthof{%
				\volumenumfont 4
			}
		}{\raggedleft\volumenumfont\thevolume}
	}{0pt}{% title
	\centering
		\parbox[][][b]{\la@student@textwidth - 140pt}{
			\raggedright \strut{#1}
		}
	}
	
\newcommand{\volume}[1]{
	\cleardoublepage
	\refstepcounter{volume}
	\pagecolor{\currentvolcolor}
	\thispagestyle{empty}
	\la@volume{#1}
	\begin{tikzpicture}[remember picture, overlay]
		\node at (current page.center) {\la@volume@illustration};
		\node [anchor = south east, inner sep = 0pt] at ($(current page.south east) + (-\la@student@spinemargin, \la@student@lowermargin)$) {
				\includegraphics[width = 150pt]{impa-capa}
			};
		\node [
			anchor = south west, inner sep = 0pt,
			font = \vphantom{Ag}\volumeauthorfont, text width = .5\la@student@textwidth, align = left
		] at ($(current page.south west) + (\la@student@foremargin, \la@student@lowermargin)$) {
			Livro Aberto de Matem√°tica
		};
	\end{tikzpicture}
	\clearpage
	\pagecolor{white}
}
